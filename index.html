<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Furqan Tuitions</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; background: #f0f4f8; margin: 0; padding: 0; }
    h1 { text-align: center; color: #2c3e50; margin-top: 20px; }
    #login, #studentPanel, #admin { max-width: 800px; margin: 20px auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    input, select, textarea, button { margin: 5px 0; padding: 10px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; width: 100%; }
    button { cursor: pointer; background-color: #3498db; color: white; border: none; transition: 0.3s; }
    button:hover { background-color: #2980b9; }
    #calendar { display: flex; flex-wrap: wrap; margin-top: 10px; }
    #calendar button { flex: 1 0 30%; margin: 5px; padding: 15px; border-radius: 10px; border: none; font-weight: bold; transition: 0.3s; }
    .taken { background-color: #27ae60; color: white; }
    .pending { background-color: #e74c3c; color: white; }
    .today { border: 3px solid #f1c40f; }
    #topics, #classTopics { margin-top: 15px; padding: 10px; background: #ecf0f1; border-radius: 8px; }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue, set, update } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";const firebaseConfig = {
  apiKey: "AIzaSyD5iFJYPEU3B0eohoFl_pGD75ZzX-onQsE",
  authDomain: "furqantuitions.firebaseapp.com",
  databaseURL: "https://furqantuitions-default-rtdb.firebaseio.com",
  projectId: "furqantuitions",
  storageBucket: "furqantuitions.appspot.com",
  messagingSenderId: "816451833675",
  appId: "1:816451833675:web:eda7c6a26f8e202effa2ce"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];

let currentStudent = '';
let currentData = {};

window.onload = () => {
  const now = new Date();
  document.getElementById('monthSelect').value = months[now.getMonth()];
  document.getElementById('admin').style.display = 'none';
};

window.loadStudent = function () {
  const name = document.getElementById('studentName').value.trim();
  if (!name) return;
  currentStudent = name;

  if(name.toLowerCase() === 'biryani'){
    document.getElementById('admin').style.display = 'block';
  } else {
    document.getElementById('admin').style.display = 'none';
  }

  document.getElementById('login').style.display = 'none';
  document.getElementById('studentPanel').style.display = 'block';
  document.getElementById('studentTitle').innerText = name;
  const studentRef = ref(db, 'students/' + name);
  onValue(studentRef, snap => {
    currentData = snap.val() || {};
    renderCalendar(currentData, name);
    renderOverallTopics(currentData);
  });
};

function renderCalendar(data, name) {
  const month = document.getElementById('monthSelect').value;
  const m = data[month] || {};
  const calendar = document.getElementById('calendar');
  calendar.innerHTML = '';
  const today = new Date().toISOString().split('T')[0];

  Object.keys(m).sort().forEach(date => {
    const btn = document.createElement('button');
    btn.innerText = `${date} ${m[date].time} - ${m[date].taken ? 'Taken' : 'Pending'}`;
    btn.className = `${m[date].taken ? 'taken' : 'pending'}${date===today ? ' today' : ''}`;
    btn.onclick = () => showClassDetails(month, date);
    calendar.appendChild(btn);
  });

  let total = Object.keys(m).length;
  let taken = Object.values(m).filter(c => c.taken).length;
  document.getElementById('summary').innerHTML = `Total: ${total} | Taken: ${taken} | Left: ${total-taken}`;
}

function renderOverallTopics(data) {
  let maths = [], physics = [];
  for(let month in data){
    for(let date in data[month]){
      if(data[month][date].maths) maths.push(data[month][date].maths);
      if(data[month][date].physics) physics.push(data[month][date].physics);
    }
  }
  document.getElementById('topics').innerHTML = `<b>Overall Topics Covered:</b><br>Maths: ${maths.join(', ')}<br>Physics: ${physics.join(', ')}`;
}

function showClassDetails(month, date){
  const cls = currentData[month][date];
  const maths = cls.maths || '';
  const physics = cls.physics || '';
  const updateMaths = prompt(`Maths topic for ${date}:`, maths);
  const updatePhysics = prompt(`Physics topic for ${date}:`, physics);
  update(ref(db, 'students/' + currentStudent + '/' + month + '/' + date), { taken: true, maths: updateMaths, physics: updatePhysics });
  renderCalendar(currentData, currentStudent);
  renderOverallTopics(currentData);
}

window.addStudentSchedule = function () {
  const name = document.getElementById('newStudent').value.trim();
  const month = document.getElementById('newMonth').value;
  const daysText = document.getElementById('newDays').value;
  if (!name || !month || !daysText) return;
  const days = daysText.split(',').map(d => d.trim());
  const updates = {};
  const now = new Date();
  days.forEach(dayTime => {
    const [day, time] = dayTime.split(' ');
    const date = new Date(now.getFullYear(), months.indexOf(month), parseInt(day));
    const dateKey = date.toISOString().split('T')[0];
    updates[dateKey] = { taken: false, time };
  });
  set(ref(db, 'students/' + name + '/' + month), updates);
  alert('Student and schedule added');
};

  </script>
</head>
<body>
  <h1>Furqan Tuitions</h1>  <div id="login">
    <h2>Student Login</h2>
    <input id="studentName" placeholder="Enter Student Name" />
    <button onclick="loadStudent()">View Schedule</button>
  </div>  <div id="studentPanel" style="display:none">
    <h2 id="studentTitle"></h2>
    <select id="monthSelect" onchange="renderCalendar(currentData, currentStudent)"></select>
    <p id="summary"></p>
    <div id="calendar"></div>
    <div id="topics"></div>
  </div>  <div id="admin">
    <h2>Admin Panel</h2>
    <h3>Add New Student & Monthly Schedule</h3>
    <input id="newStudent" placeholder="Student Name" />
    <select id="newMonth">
      <option value="January">January</option>
      <option value="February">February</option>
      <option value="March">March</option>
      <option value="April">April</option>
      <option value="May">May</option>
      <option value="June">June</option>
      <option value="July">July</option>
      <option value="August">August</option>
      <option value="September">September</option>
      <option value="October">October</option>
      <option value="November">November</option>
      <option value="December">December</option>
    </select>
    <textarea id="newDays" placeholder="Enter days and time (comma separated, e.g. 5 10:00,7 12:00)"></textarea>
    <button onclick="addStudentSchedule()">Add Student & Schedule</button>
  </div>
</body>
</html>
